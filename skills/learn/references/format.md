# Learning Format Reference

## Scope Classification

| Scope | When to use | Destination root |
|---|---|---|
| `project` | Codebase-specific: errors, patterns, domain facts, workflows | `{origin_project_path}/` |
| `universal` | Agent-behavioral: mistakes, user preferences, tool quirks | `~/.claude/rules/` |

### Scope Decision

- If the learning only matters for ONE specific project → `project`
- If the learning applies across ALL projects → `universal`

## Type Classification

| Type | Scope | Default destination | Example |
|---|---|---|---|
| `error` | project | `{origin}/CLAUDE.md` > Error Patterns | "CORS middleware must be before auth" |
| `pattern` | project | `{origin}/CLAUDE.md` > Learned Patterns | "Inline glob hints at every reference" |
| `knowledge` | project | `{origin}/.claude/rules/{topic}.md` | "Events table uses soft deletes" |
| `workflow` | project | `{origin}/.claude/rules/{topic}.md` | "Deploy requires migrations first" |
| `agent-mistake` | universal | `~/.claude/rules/{topic}.md` | "Don't assume test failures mean code is wrong" |
| `user-preference` | universal | `~/.claude/rules/{topic}.md` | "Always run tests before committing" |
| `tool-behavior` | universal | `~/.claude/rules/{topic}.md` | "Anytype update-object cannot update body" |
| `skill-fix` | project | Full absolute path (see `routing.md` Group D) | Skill SKILL.md had wrong instructions |
| `script-fix` | project | Full absolute path (see `routing.md` Group D) | Hook script had a bug |
| `review-rule` | project | `{origin}/.claude/review-rules.md` | Recurring code review finding |

### Root Cause → Type Mapping

Correction Capture uses root causes. Digest Processing uses types. They map to each other:

| Correction Capture root cause | Digest Processing type | Notes |
|---|---|---|
| `claude-md` | `error` or `pattern` | error = something broke; pattern = a better way |
| `knowledge` | `knowledge` or `workflow` | knowledge = codebase fact; workflow = process/sequence |
| `skill` | `skill-fix` | |
| `script` | `script-fix` | |
| `general` | _(nothing written)_ | Agent reasoning error, no doc needed |
| `agent-mistake` | `agent-mistake` | Same in both |
| `user-preference` | `user-preference` | Same in both |
| `tool-behavior` | `tool-behavior` | Same in both |

### Title Format

Concise imperative statement (like a commit message).
- Good: "Use WAL mode for SQLite to prevent BUSY errors"
- Bad: "I found a bug with SQLite"

## unprocessed-corrections.md Format

Generated by `stop-learn-reflect.sh`. The script controls the format — read the actual file in context to understand its current structure. Each session block header contains the absolute project path for routing.
